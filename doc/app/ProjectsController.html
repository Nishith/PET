<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

  <title>Class: ProjectsController</title>

  <link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

  <script src="./js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="./app/controllers/projects_controller_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="app/controllers/projects_controller.rb">app/controllers/projects_controller.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="ApplicationController.html">ApplicationController</a></p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-i-create">#create</a></li>
          
          <li><a href="#method-i-destroy">#destroy</a></li>
          
          <li><a href="#method-i-edit">#edit</a></li>
          
          <li><a href="#method-i-index">#index</a></li>
          
          <li><a href="#method-i-new">#new</a></li>
          
          <li><a href="#method-i-show">#show</a></li>
          
          <li><a href="#method-i-sort">#sort</a></li>
          
          <li><a href="#method-i-update">#update</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="./doc/README_FOR_APP.html">README_FOR_APP</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./User.html">User</a></li>
        
          <li><a href="./User/InvitationsController.html">User::InvitationsController</a></li>
        
          <li><a href="./Ability.html">Ability</a></li>
        
          <li><a href="./ApplicationController.html">ApplicationController</a></li>
        
          <li><a href="./ApplicationHelper.html">ApplicationHelper</a></li>
        
          <li><a href="./DeliverableType.html">DeliverableType</a></li>
        
          <li><a href="./EffortLog.html">EffortLog</a></li>
        
          <li><a href="./EffortLogsController.html">EffortLogsController</a></li>
        
          <li><a href="./EffortLogsHelper.html">EffortLogsHelper</a></li>
        
          <li><a href="./HistoricalData.html">HistoricalData</a></li>
        
          <li><a href="./HistoricalDataController.html">HistoricalDataController</a></li>
        
          <li><a href="./HistoricalDataHelper.html">HistoricalDataHelper</a></li>
        
          <li><a href="./HomeController.html">HomeController</a></li>
        
          <li><a href="./HomeHelper.html">HomeHelper</a></li>
        
          <li><a href="./Lifecycle.html">Lifecycle</a></li>
        
          <li><a href="./LifecyclePhase.html">LifecyclePhase</a></li>
        
          <li><a href="./LifecyclePhaseDeliverable.html">LifecyclePhaseDeliverable</a></li>
        
          <li><a href="./LifecyclePhaseDeliverablesController.html">LifecyclePhaseDeliverablesController</a></li>
        
          <li><a href="./LifecyclePhaseDeliverablesHelper.html">LifecyclePhaseDeliverablesHelper</a></li>
        
          <li><a href="./LifecyclePhasesController.html">LifecyclePhasesController</a></li>
        
          <li><a href="./LifecyclePhasesHelper.html">LifecyclePhasesHelper</a></li>
        
          <li><a href="./LifecyclesController.html">LifecyclesController</a></li>
        
          <li><a href="./LifecyclesHelper.html">LifecyclesHelper</a></li>
        
          <li><a href="./Project.html">Project</a></li>
        
          <li><a href="./ProjectPhase.html">ProjectPhase</a></li>
        
          <li><a href="./ProjectPhaseDeliverable.html">ProjectPhaseDeliverable</a></li>
        
          <li><a href="./ProjectPhaseDeliverablesController.html">ProjectPhaseDeliverablesController</a></li>
        
          <li><a href="./ProjectPhaseDeliverablesHelper.html">ProjectPhaseDeliverablesHelper</a></li>
        
          <li><a href="./ProjectPhasesController.html">ProjectPhasesController</a></li>
        
          <li><a href="./ProjectPhasesHelper.html">ProjectPhasesHelper</a></li>
        
          <li><a href="./ProjectsController.html">ProjectsController</a></li>
        
          <li><a href="./ProjectsHelper.html">ProjectsHelper</a></li>
        
          <li><a href="./Uom.html">Uom</a></li>
        
          <li><a href="./UserHelper.html">UserHelper</a></li>
        
          <li><a href="./UsersController.html">UsersController</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">ProjectsController</h1>

    <div id="description" class="description">
      
<p>The projects controller manages Projects. Available actions include
creation, modification, deletion and show. All actions except listing all
projects and viewing a single project require the user to be logged in.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="create-method" class="method-detail ">
          <a name="method-i-create"></a>

          
          <div class="method-heading">
            <span class="method-name">create</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Triggered by POST /projects and POST /projects.xml Receive the parameters
from client side and create a new <a href="Project.html">Project</a>.</p>
            

            
            <div class="method-source-code" id="create-source">
<pre>
<span class="ruby-comment"># File app/controllers/projects_controller.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
  <span class="ruby-ivar">@new_project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:project</span>])
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@new_project</span>.<span class="ruby-identifier">lifecycle_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@new_project</span>.<span class="ruby-identifier">lifecycle_name</span> = <span class="ruby-string">&quot;None&quot;</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@new_project</span>.<span class="ruby-identifier">save</span>

  <span class="ruby-identifier">lf_names</span> = <span class="ruby-constant">Lifecycle</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;name&quot;</span>)
  <span class="ruby-identifier">lf_name_array</span> = []
  <span class="ruby-identifier">lf_names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">lfn</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">lf_name_array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lfn</span>.<span class="ruby-identifier">name</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">lf_name_array</span>.<span class="ruby-identifier">include?</span> <span class="ruby-ivar">@new_project</span>.<span class="ruby-identifier">lifecycle_name</span>) <span class="ruby-keyword">then</span>
    <span class="ruby-comment">#want to copy all data from the lifecycle to the project</span>
    <span class="ruby-identifier">lf</span> = <span class="ruby-constant">Lifecycle</span>.<span class="ruby-identifier">find_all_by_name</span>(<span class="ruby-ivar">@new_project</span>.<span class="ruby-identifier">lifecycle_name</span>).<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">lf</span>.<span class="ruby-identifier">lifecycle_phases</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">lf_phase</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">pf</span> = <span class="ruby-constant">ProjectPhase</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lf_phase</span>.<span class="ruby-identifier">name</span>, <span class="ruby-value">:description</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lf_phase</span>.<span class="ruby-identifier">description</span>, <span class="ruby-value">:project_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@new_project</span>.<span class="ruby-identifier">id</span>,
        <span class="ruby-value">:position</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lf_phase</span>.<span class="ruby-identifier">position</span>)
      <span class="ruby-identifier">pf</span>.<span class="ruby-identifier">save</span>

      <span class="ruby-identifier">lf_phase</span>.<span class="ruby-identifier">lifecycle_phase_deliverables</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">lf_ph_deliverable</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">name</span> = <span class="ruby-identifier">lf_ph_deliverable</span>.<span class="ruby-identifier">deliverable_type</span>.<span class="ruby-identifier">blank?</span><span class="ruby-operator">?</span> <span class="ruby-string">&quot;None&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">lf_ph_deliverable</span>.<span class="ruby-identifier">deliverable_type</span>.<span class="ruby-identifier">name</span>
        <span class="ruby-identifier">deliverable</span> = <span class="ruby-constant">ProjectPhaseDeliverable</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:description</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lf_ph_deliverable</span>.<span class="ruby-identifier">description</span>,
                                                  <span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>,
                                                  <span class="ruby-value">:uom_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lf_ph_deliverable</span>.<span class="ruby-identifier">uom_id</span>,
                                                  <span class="ruby-value">:deliverable_type_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lf_ph_deliverable</span>.<span class="ruby-identifier">deliverable_type_id</span>,
                                                  <span class="ruby-value">:project_phase_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pf</span>.<span class="ruby-identifier">id</span>,
                                                  <span class="ruby-value">:position</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lf_ph_deliverable</span>.<span class="ruby-identifier">position</span>)
        <span class="ruby-identifier">deliverable</span>.<span class="ruby-identifier">save</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>



  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@new_project</span>.<span class="ruby-identifier">save</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-ivar">@new_project</span>, <span class="ruby-value">:notice</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'Project was successfully created.'</span>) }
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@new_project</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:created</span>, <span class="ruby-value">:location</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@new_project</span> }
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;new&quot;</span>}
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@new_project</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- create-source -->
            
          </div>

          

          
        </div><!-- create-method -->

      
        <div id="destroy-method" class="method-detail ">
          <a name="method-i-destroy"></a>

          
          <div class="method-heading">
            <span class="method-name">destroy</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Triggered by DELETE /projects/1 and DELETE /projects/1.xml Delete a project
and its associated deliverable phases and deliverables. A project will not
be deleted if there is an effort log associated with it</p>
            

            
            <div class="method-source-code" id="destroy-source">
<pre>
<span class="ruby-comment"># File app/controllers/projects_controller.rb, line 132</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy</span>
  <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-ivar">@phases</span> = <span class="ruby-constant">ProjectPhase</span>.<span class="ruby-identifier">find_all_by_project_id</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-ivar">@phases</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@deliverables</span> = <span class="ruby-constant">ProjectPhaseDeliverable</span>.<span class="ruby-identifier">find_all_by_project_phase_id</span>(<span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>)
    <span class="ruby-ivar">@deliverables</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ds</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@logged</span> = <span class="ruby-constant">EffortLog</span>.<span class="ruby-identifier">find_all_by_project_phase_deliverable_id</span>(<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">id</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@logged</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:null</span>
        <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-string">'Project could not be deleted as there was effort logged against it.'</span>
        <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">projects_url</span>)
        <span class="ruby-keyword">return</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@phases</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@deliverables</span> = <span class="ruby-constant">ProjectPhaseDeliverable</span>.<span class="ruby-identifier">find_all_by_project_phase_id</span>(<span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>)
    <span class="ruby-ivar">@deliverables</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ds</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">destroy</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">p</span>.<span class="ruby-identifier">destroy</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">destroy</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">projects_url</span>) }
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">head</span> <span class="ruby-value">:ok</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- destroy-source -->
            
          </div>

          

          
        </div><!-- destroy-method -->

      
        <div id="edit-method" class="method-detail ">
          <a name="method-i-edit"></a>

          
          <div class="method-heading">
            <span class="method-name">edit</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Triggered by GET /projects/1/edit Display the editing form</p>
            

            
            <div class="method-source-code" id="edit-source">
<pre>
<span class="ruby-comment"># File app/controllers/projects_controller.rb, line 58</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">edit</span>
  <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
<span class="ruby-keyword">end</span></pre>
            </div><!-- edit-source -->
            
          </div>

          

          
        </div><!-- edit-method -->

      
        <div id="index-method" class="method-detail ">
          <a name="method-i-index"></a>

          
          <div class="method-heading">
            <span class="method-name">index</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Triggered by GET /projects and GET /projects.xml Display all projects</p>
            

            
            <div class="method-source-code" id="index-source">
<pre>
<span class="ruby-comment"># File app/controllers/projects_controller.rb, line 14</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>
  <span class="ruby-ivar">@projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">all</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment"># index.html.erb</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@projects</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- index-source -->
            
          </div>

          

          
        </div><!-- index-method -->

      
        <div id="new-method" class="method-detail ">
          <a name="method-i-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Triggered by GET /projects/new and GET /projects/new.xml Display the
creation form for the users to create a new project</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File app/controllers/projects_controller.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@new_project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment"># new.html.erb</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@new_project</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
        <div id="show-method" class="method-detail ">
          <a name="method-i-show"></a>

          
          <div class="method-heading">
            <span class="method-name">show</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Triggered by GET /projects/1 and GET /projects/1.xml Show the project
specified by the user</p>
            

            
            <div class="method-source-code" id="show-source">
<pre>
<span class="ruby-comment"># File app/controllers/projects_controller.rb, line 25</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">show</span>
  <span class="ruby-ivar">@projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-ivar">@new_project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-ivar">@project_phase</span> = <span class="ruby-constant">ProjectPhase</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@project_phase</span>.<span class="ruby-identifier">project_id</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">id</span>
  <span class="ruby-identifier">number_of_phases</span> = <span class="ruby-constant">ProjectPhase</span>.<span class="ruby-identifier">find_all_by_project_id</span>(<span class="ruby-ivar">@project</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">size</span>
  <span class="ruby-ivar">@project_phase</span>.<span class="ruby-identifier">position</span> = <span class="ruby-identifier">number_of_phases</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>

  <span class="ruby-ivar">@new_project_phase_deliverable</span> = <span class="ruby-constant">ProjectPhaseDeliverable</span>.<span class="ruby-identifier">new</span>



  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment"># show.html.erb</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- show-source -->
            
          </div>

          

          
        </div><!-- show-method -->

      
        <div id="sort-method" class="method-detail ">
          <a name="method-i-sort"></a>

          
          <div class="method-heading">
            <span class="method-name">sort</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Receive the ajax query from project<a
href="ProjectsController.html#method-i-show">show</a> page and remember the
order of phases in database Note: If at some point there are restrictions
to the projects that a manager can view, this validation has to be added to
this method so that the phases all belong to the same project and that the
user has edit permissions on that project.</p>
            

            
            <div class="method-source-code" id="sort-source">
<pre>
<span class="ruby-comment"># File app/controllers/projects_controller.rb, line 166</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sort</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">'phase'</span>].<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Array</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-string">'phase'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">phase</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@phase</span> = <span class="ruby-constant">ProjectPhase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">phase</span>)
      <span class="ruby-ivar">@phase</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-string">&quot;position&quot;</span>,<span class="ruby-identifier">params</span>[<span class="ruby-string">'phase'</span>].<span class="ruby-identifier">index</span>(<span class="ruby-ivar">@phase</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> { <span class="ruby-identifier">head</span> <span class="ruby-value">:ok</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- sort-source -->
            
          </div>

          

          
        </div><!-- sort-method -->

      
        <div id="update-method" class="method-detail ">
          <a name="method-i-update"></a>

          
          <div class="method-heading">
            <span class="method-name">update</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Triggered by PUT /projects/1 and PUT /projects/1.xml Receive the parameters
from client side and update the <a href="Project.html">Project</a>.</p>
            

            
            <div class="method-source-code" id="update-source">
<pre>
<span class="ruby-comment"># File app/controllers/projects_controller.rb, line 114</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>
  <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:project</span>])
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-ivar">@project</span>, <span class="ruby-value">:notice</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'Project was successfully updated.'</span>) }
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">head</span> <span class="ruby-value">:ok</span> }
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;edit&quot;</span> }
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span>  { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- update-source -->
            
          </div>

          

          
        </div><!-- update-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

